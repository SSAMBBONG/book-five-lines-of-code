# 긴 코드 조각내기

## 첫번째 규칙: 왜 다섯 줄인가?

### 규칙 : 다섯 줄 제한

- 메서드는 {와 }를 제외하고 5줄 이상이 되어서는 안된다.
- 문장(코드 한 줄)은 if, for, while 또는 세미콜론으로 끝나는 모든 것을 말한다.
- 할당, 메서드 호출, return 같은 것이다.
- 공백과 중괄호({ 및 })는 제외한다.

#### 스멜

- 메서드가 길다는 것 자체가 스멜이다.
- 메서드는 한 가지 작업만 해야한다.

#### 의도

- 오랜시간 개발할수록 더 많은 기능이 추가되면서 메서드가 커질 수 있다. 이로인해 코드 이해가 어려워진다.
- 5줄의 코드가 있는 4개의 메서드가 20줄인 하나의 메서드보다 훨씬 빠르고 이해하기 쉽다.

## 함수 분해를 위한 리팩터링 패턴 소개

![](https://velog.velcdn.com/images/bapdung/post/d3c74a48-1ed3-417b-8143-d246b54d7b99/image.png)

- draw 함수내에 있는 기능 주석을 바탕으로 함수로 쪼개준다.
- 주석을 메서드명으로 이용해서 모듈화시킨다.

### 메서드 추출

- 한 메서드에서 일부를 취해서 자체 메서드로 추출한다.
- 1)여러 매개변수가 필요하거나 2)여러조건에서 전체가 아닌 일부조건을 return할 경우는 복잡해질 수 있다.

#### 절차

> 1. 추출할 줄의 주변을 빈줄로 표시, 혹은 주석 표시
> 2. 원하는 이름으로 새로운 빈 메서드 만들기
> 3. 그룹의 맨 위에서 새로운 메서드 호출
> 4. 그룹의 모든 줄을 선택 후 잘라내서 메서드에 붙여넣기
> 5. 컴파일하기
> 6. 매개변수 도입해 호출하는 쪽의 오류 발생
> 7. 오류 해결(return 타입을 이용)
> 8. 컴파일
> 9. 호출 시 인자전달을 통해 오류 잡기
> 10. 사용하지 않는 빈 줄과 주석 제거

![](https://velog.velcdn.com/images/bapdung/post/9468aeaf-2460-4fcc-b65c-d940108b2f58/image.png)

- 이러한 예시를 통해 알 수 있는 점은 변환은 번거롭지만 **안전**하다.
- 손상시키지 않고 안전한 코드의 변형이 가능하다.

## 추상화 수준을 맞추기 위한 함수 분해

### 규칙 : 호출 또는 전달, 한 가지만 할 것

- 함수 내에서 객체에 있는 메서드를 호출하거나 객체를 인자로 전달할 수는 있지만 섞어 사용해서는 안된다.
- 더 많은 메서드를 도입하고 여러가지를 매개변수로 전달하기 시작하면 책임이 고르지 않게 될 수도 있다.
  ![](https://velog.velcdn.com/images/bapdung/post/20c04b68-8763-48b7-a06e-491a5bae00d1/image.png)
- sum(arr)은 높은 구현의 추상화이고, arr.length는 낮은 구현의 추상화이다.
- 높은 수준의 호출과 낮은 수준의 작업의 공존은 메서드 이름 사이의 불일치로 가독성이 떨어질 수 있다.
- 따라서 size(arr)인 높은 구현의 추상화 이용해서 추상화 수준 일치시켜야한다.

## 좋은 함수 이름의 속성

- 정직해야한다. 함수의 의도를 설명해야 한다.
- 완전해야한다. 함수가 하는 모든 것들을 담아야한다.
- 도메인에서 일하는 사람이 이해할 수 있어야한다. 작업 중인 도메인에서 사용하는 단어를 사용해야한다. 그러면 의사소통이 더욱 효율적이게 되고 팀원 및 고객과 코드에 대해 더 쉽게 이야기할 수 있다는 장점이 있다.

## 너무 많은 일을 하는 함수 분리하기

![](https://velog.velcdn.com/images/bapdung/post/361ef5e4-d412-404e-a88b-07db5f7725bc/image.png)

- 1)숫자를 반복하고 2) 숫자가 소수인지 확인하는 두 가지 일이 반복된다.
- 무언가를 확인하는 것(예시에서는 if문)은 하나의 작업이며 하나의 함수에서 처리해야한다.
  ![](https://velog.velcdn.com/images/bapdung/post/4ee2038e-6907-4c01-9763-6cb47d54e344/image.png)
  > 정리
  >
  > 1. 다섯 줄 제한 규칙 : 메서드는 다섯 줄 이하여야 한다. 두 가지 이상의 작업을 수행하는 메서드를 식별하는데 도움이 된다. 긴 메서드를 분해하고 메서드 이름으로 주석을 대체한다.
  > 2. 호출 또는 전달, 한 가지만 할 것 : 하나의 메서드 내에서 객체에 있는 메서드를 호출하거나 객체를 매개변수로 전달할 수 있지만, 둘 다 해서는 안된다. 여러수준의 추상화가 섞여있는 메서드 식별에 도움이 된다. 서로 다른 수준의 추상화를 분리할 수 있다.
  > 3. 메서드 이름은 투명하고 완전할 것 : 메서드 추출을 사용하면 가독성이 향상되도록 매개변수의 이름을 이해되도록 바꿔야한다.
  > 4. if문은 함수의 시작에만 배치 : if를 통해 조건 확인하는 경우는 한 가지 작업만 수행하므로 메서드로 분리할 것. if문이 있으면 메서드가 다른 작업을 수행하지 못하게 하기 때문이다.
