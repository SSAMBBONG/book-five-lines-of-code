# 리팩토링 깊게 들여다보기

## 가독성 및 유지보수성 향상

### 코드 개선

- 좋은 코드는 가독성과 유지보수성이 뛰어나다.

#### 가독성

- 의도를 전달하기 위한 코드의 성질
- 코딩 컨벤션을 지정하고 따르는 것, 주석 달기, 변수, 메서드, 클래스 및 파일 이름 지정, 공백 사용 등
  ![](https://velog.velcdn.com/images/bapdung/post/3a82769c-9e86-4b5d-b75a-aaeecf20eede/image.png)

#### 유지보수성

- 버그를 고치거나 추가하기 위해 일부 기능을 변경해야할 때마다 새 코드를 어디에 놓을지 후보위치를 조사해야한다. 유지보수성은 얼마나 많은 후보를 조사해야하는지를 나타내는 표현이다.
- 조사 단계에서 시간이 오래걸린다는 것은 코드 유지보수성이 나쁜 것이며 개선해야한다.
- 한군데서 무언가를 수정했을 때 관련없어보이는 다른곳에 문제가 발생한다면 **취약하다(fragile)** 고 말한다.
- 취약성의 근원은 **전역상태(global state)** 이다. 우리가 고려한 범위를 벗어난 것을 의미한다.
- 코드에서 상태(조건)를 명시적으로 확인하지 않는 **불변속성**을 줄여야 한다. 시스템이 변경될 때 불변속성이 유요한 상태로 유지되기 어렵기 때문이다.
- 변수를 명시적으로 체크해서 불변속성을 제거함으로써 유지보수성을 향상시킬 수는 있으나, 코드가 수행하는 작업이 변경된다. 따라서 불변속성을 쉽게 볼 수 있도록 서로 가깝게 이동시켜 유지보수성을 향상시키는 방법을 택해야한다.
- 이는 곧 '**불변속성의 범위제한(localizing invariants)** : 함께 변하는 것은 함께 있어야한다' 를 의미한다.

### 코드가 하는 일을 바꾸지 않고 유지보수하기

- 코드를 블랙박스라 생각하고 외부에 영향을 주지 않는 내부의 모든 작업만 변경하기!
- 누군가가 내가 리팩토링하는 코드를 변경하면 충돌이 일어날 수 있기 때문에 리팩토링중인 코드를 **예약**해서 다른 사람이 변경하지 못하도록 막아야한다.
- 예약한 코드가 적을 수록 변경사항 충돌 위험성 낮아짐
  > **리팩토링의 세 가지 핵심**
  >
  > 1. 의도를 전달함으로써 가독성 향상
  > 2. 불변속성의 범위제한을 통한 유지보수성 향상
  > 3. 범위 밖의 코드에 영향을 주지 않고 1항, 2항을 수행

## 속도, 유연성 및 안정성 확보

### 상속보다는 컴포지션사용

![](https://velog.velcdn.com/images/bapdung/post/b80f8198-98f6-4167-a8c7-8262a849dd7e/image.png)

- 여기서 만약 `CommonBird`에 `canSwim()`메서드를 추가한다고 가정해보자.
- 컴포지션에서는 `canSwim()`을 구현하지 않아 컴파일 오류가 나지만 상속에서는 override하지 않는이상 오류가 나지 않는다.
- 즉, 개발자가 상속관계에 대해 제대로 기억하고 있지 않으면 오류가 발생할 수 있다. (사람의 기억력을 믿지 말것)

#### 유연성

- 컴포지션 중심으로 만들어진 시스템을 사용하면 더 깔끔하게 코드 결합 및 재사용 가능

### 수정이 아니라 추가로 코드를 변경

- 컴포지션은 **추가(addition)** 로 변경이 가능하다.
- **개방-폐쇠 원칙** : SW 구성 요소들은 확장에 대해 열려있어야하고, 수정에 대해 닫혀있어야 한다.

#### 프로그래밍속도

- 새로운 것을 구현하거나 버그를 수정할 때 기존 코드를 건들지 않고 변경가능하다면 시간 절약이 가능하다.
- 코드베이스가 빠르게 늘어나는것은 문제가 될 수 있다는 점을 참고해야한다. 사용하지 않는 코드는 버리는 것이 좋다.

#### 안정성

- 추가에 의한 변경방식을 따르면 기존 코드 보존이 가능하다.

## 리팩토링과 일상 업무

- 리팩토링은 프로그래머의 일상업무가 되어야 한다. 리팩토링하지 않은 코드의 공유는 다른 프로그래머의 시간을 뺏는것이다. 그러한 코드의 공유로 인해 **기술부채**가 발생할 수 있다.
