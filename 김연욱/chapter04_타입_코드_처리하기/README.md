> # Chapter 04 <br><br> **타입 코드 처리하기**

## 주요 내용

- if 문에서 else를 사용하지 말 것, switch를 사용하지 말 것으로 이른 바인딩(early binding) 제거하기
- 클래스로 타입 코드 대체와 클래스로의 코드 이관으로 if 문 제거하기
- 메서드 전문화로 문제가 있는 일반성 제거하기
- 인터페이스에서만 상속받을 것으로 코드 간 커플링(결합) 방지하기
- 메서드의 인라인화 및 삭제 후 컴파일하기를 통한 불필요한 메서드 제거

## 규칙: if 문에서 else를 사용하지 말 것

- 정의 : 프로그램에서 이해하지 못하는 타입(형)인지를 검사하지 않는 한 if 문에서 else를 사용하지 말 것
- if-else는 하드코딩된 결정으로 볼 수 있음
- 스멜로 인식되는 이른 바인딩(early binding)은 좋지 않음

## 리팩터린 패턴: 클래스로 타입 코드 대체

- 열거형을 인터페이스로 변환하고 열거형의 값들은 클래스가 되는 것
- 그렇게 하면 각 값에 속성을 추가하고 해당 특정 값과 관련된 기능을 특성에 맞게 만들 수 있음

## 리팩터링 패턴: 클래스로의 코드 이관

- 기능을 클래스로 옮기기 때문에 클래스로 타입 코드 대체 패턴의 자연스러운 연장선임
- 결과적으로 if 구문이 제거되고 기능이 데이터에 더 가까이 이동함
- 특정 값과 연결된 기능이 값에 해당하는 클래스로 이동하기 때문에 이는 불변속성을 지역화하는 데 도움이 됨

## 리팩터링 패턴: 메서드의 인라인화

- 프로그램에서 더 이상 가독성에 도움이 되지 않는 메서드를 제거해야함
- 이에 대한 방법은 메서드에서 이를 호출하는 모든 곳으로 코드를 옮기는 것
- 이것은 일반적으로 호출하는 측을 단순화 하기 위한 것으로 모든 호출 측을 수정하여 원래의 메서드를 제거하는 것임
- 절차
    1. 메서드 이름을 임시로 변경한다
    2. 그러면 함수를 사용하는 모든 곳에서 컴파일러 오류가 발생한다
    3. 메서드의 본문을 복사하고 매개변수를 기억해 둔다
    4. 컴파일러가 오류를 발생시킨 모든 곳의 호출을 복사된 코드로 교체하고 인자를 매개변수에 매핑한다
    5. 오류 없이 컴파일되면 원래의 메서드가 더 이상 사용되지 않는 것이므로 원래 메서드를 삭제한다

## 규칙: switch를 사용하지 말 것

- 정의 : default 케이스가 없고 모든 case에 반환 값이 있는 경우가 아니라면 switch를 사용하지 말 것

## 규칙: 인터페이스에서만 상속받을 것

- 정의
    - 상속은 오직 인터페이스를 통해서만 받음

## 리팩터링 패턴: 삭제 후 컴파일하기

- 인터페이스의 전체 범위를 알고 있을 때 인터페이스에서 사용하지 않는 메서드를 제거하는 것
- 단, 아직 사용하지 않는 메서드를 삭제할 수 있기 때문에 새로운 기능을 구현하는 동안에는 이 리팩터링 패턴을 수행하지 말 것
- 절차
    1. 컴파일한다 (오류가 없어야 함)
    2. 인터페이스에서 메서드를 삭제한다
    3. 컴파일한다
        
        3.1. 컴파일 오류가 발생하면 삭제를 취소하고 계속 진행한다
        
        3.2. 그렇지 않으면 각 클래스를 살펴보고 오류 없이 해당 메서드를 삭제할 수 있는지 확인한다
        

## 요약

- if 문에서 else를 사용하지 말 것(R4.1.1)
- switch를 사용하지 말 것(R4.2.4)
- 애플리케이션의 핵심에서는 클래스로 타입 코드 대체(P4.1.3) 및 클래스로의 코드 이관(P4.1.5) 리팩터링 패턴을 사용해서 switch와 연속된 else if 구문을 높은 수준의 클래스와 메서드로 대체해야 함
- 지나치게 일반화된 메서드는 리팩터링을 방해할 수 있으니 이런 경우 불필요한 일반성을 제거하기 위해 메서드 전문화(P4.2.2) 리팩터링 패턴을 사용할 수 있음
- 인터페이스에서만 상속받을 것(P4.3.2) 규칙은 추상 클래스와 클래스 상속을 사용해 코드를 재사용하는 것을 방지함
- 리팩터링 후 정리를 위한 두 가지 리팩터링 패턴은 메서드의 인라인화(P4.1.7)와 삭제 후 컴파일하기(P4.5.1)로 더 이상 가독성에 도움이 되지 않는 메서드를 제거할 수 있음